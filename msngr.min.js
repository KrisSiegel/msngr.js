var msngr=msngr||function(){"use strict";var a={},b=function(){var a=Array.prototype.slice.call(arguments,0);return b.message.apply(this,a)};return b.version="5.1.0",b.extend=function(c){if(void 0!==c&&null!==c){var d=Object.prototype.toString.call(c);if("[object Function]"===d)return c.apply(this,[b,a])}},Object.defineProperty(b,"debug",{set:function(c){c===!0?b.internal=a:c===!1&&delete b.internal},get:function(){return void 0!==b.internal}}),b}();msngr.extend(function(a,b){"use strict";b.InvalidParametersException=function(b,c){var d={name:"InvalidParametersException",severity:"unrecoverable",message:"Invalid parameters supplied to the {method} method".replace("{method}",b)};return a.is(c).empty||(d.message=d.message+" "+c),d},b.DuplicateException=function(a){return{name:"DuplicateException",severity:"unrecoverable",message:"Duplicate input provided to {method} where duplicates are not allowed.".replace("{method}",a)}},b.ReservedKeywordsException=function(a){return{name:"ReservedKeywordsException",severity:"unrecoverable",message:"Reserved keyword {keyword} supplied as action.".replace("{keyword}",a)}},b.MangledException=function(a,b){return{name:"MangledException",severity:"unrecoverable",message:"The {variable} was unexpectedly mangled in {method}.".replace("{variable}",a).replace("{method}",b)}}}),msngr.extend(function(a,b){"use strict";var c={arguments:"[object Arguments]",boolean:"[object Boolean]",string:"[object String]",date:"[object Date]",array:"[object Array]",number:"[object Number]",object:"[object Object]",function:"[object Function]",undefined:"[object Undefined]",null:"[object Null]",symbol:"[object Symbol]",nodeList:"[object NodeList]"},d=function(a){return Object.prototype.toString.call(a)},e={htmlElement:function(a){return 0===a.indexOf("[object HTML")||0===a.indexOf("[object global]")},promise:function(a,b){return"[object Promise]"===a||(a===c.object||a===c.function)&&(void 0!==item.then&&d(item.then)===c.function)}},f=function(a,b,f){return f?e[a](d(b),b):d(b)===c[a]},g=function(a,b){switch(a){case c.undefined:case c.null:return!0;case c.string:return 0===b.trim().length;case c.object:return 0===Object.keys(b).length;case c.array:return 0===b.length;default:return!1}},h=function(a){var b={},h=function(c,d){for(var e in c)c.hasOwnProperty(e)&&!function(c){Object.defineProperty(b,c,{get:function(){for(var b=0;b<a.length;++b)if(!f(c,a[b],d))return!1;return!0}})}(e)};return h(c,!1),h(e,!0),Object.defineProperty(b,"there",{get:function(){for(var b=0;b<a.length;++b)if(void 0===a[b]||null===a[b])return!1;return!0}}),Object.defineProperty(b,"empty",{get:function(){for(var b=0;b<a.length;++b)if(!g(d(a[b]),a[b]))return!1;return!0}}),b};b.types=c,a.is=function(){var a=Array.prototype.slice.call(arguments,0);a=a||[void 0];var b=h(a);return b.getType=function(){return Object.prototype.toString.call(a[0])},b.getTypes=function(){for(var b=[],c=0;c<a.length;++c)b.push(Object.prototype.toString.call(a[c]));return b},b},a.is.browser="undefined"!=typeof XMLHttpRequest}),msngr.extend(function(a,b){"use strict";a.deDupeArray=function(a){for(var b={},c=[],d=a.length,e=0;e<d;++e)void 0===b[a[e]]&&(b[a[e]]=!0,c.push(a[e]));return c}}),msngr.extend(function(a,b){"use strict";var c=0,d="Mxxx".replace(/[x]/g,function(){return Math.floor(100*Math.random())});a.id=function(){return++c,d+c},a.uuid=function(){var b=a.now(),c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=(b+16*Math.random())%16|0;return b=Math.floor(b/16),("x"==a?c:3&c|8).toString(16)});return c}}),msngr.extend(function(a,b){"use strict";var c,d="__msngr_immediate";if("undefined"!=typeof window&&"undefined"!=typeof window.postMessage){var e=[];window.addEventListener("message",function(a){a.source===window&&a.data===d&&(a.stopPropagation(),e.length>0&&e.shift()())},!0)}a.immediate=function(a){void 0===c&&(c="undefined"!=typeof setImmediate?setImmediate:"undefined"!=typeof window&&"undefined"!=typeof window.postMessage?function(a){e.push(a),window.postMessage(d,"*")}:function(a){setTimeout(a,0)}),c(a)}}),msngr.extend(function(a,b){"use strict";var c=void 0,d="",e=void 0,f=function(){return performance.now()},g=function(){return process.hrtime()[1]/1e6},h=function(){return Date.now()};a.now=function(b){void 0===c&&("undefined"!=typeof performance?(c=f,d="performance"):"undefined"!=typeof process?(c=g,d="node"):(c=h,d="legacy"));var i=c();return b===!0&&e===i?a.now(b):(e=i,i)}}),msngr.extend(function(a,b){"use strict";a.asyncify=function(b){return a.is(b).function&&(b.async=function(){var c=[].slice.call(arguments),d=c.pop();a.is(d).function&&!function(c,d){a.immediate(function(){try{d.apply(null,[null,b.apply(null,c)])}catch(a){d.apply(null,[a,null])}})}(c,d)}),b}}),msngr.extend(function(a,b){"use strict";var c={};c[b.types.string]=function(a){return a},c[b.types.number]=function(a){return a},c[b.types.boolean]=function(a){return a},c[b.types.date]=function(a){var b=new Date;return b.setTime(a.getTime()),b},c[b.types.object]=function(b){var c={};for(var d in b)b.hasOwnProperty(d)&&(c[d]=a.copy(b[d]));return c},c[b.types.array]=function(b){for(var c=[],d=0;d<b.length;d++)c[d]=a.copy(b[d]);return c},c[b.types.function]=function(b){var c=b.bind({});for(var d in b)b.hasOwnProperty(d)&&(c[d]=a.copy(b[d]));return c},a.copy=function(b){if(void 0===b||null===b)return b;var d=a.is(b).getType();return void 0!==c[d]?c[d](b):b}}),msngr.extend(function(a,b){"use strict";var c=[b.types.object,b.types.function,b.types.array],d=[b.types.object,b.types.array],e=function(f,g,h){if(void 0===f||null===f)return g;if(void 0===g||null===g)return f;var i=a.is(f).getType(),j=a.is(g).getType(),k=void 0;if(c.indexOf(i)!==-1&&d.indexOf(j)!==-1||(k=b.InvalidParametersException("msngr.merge()","Only objects, arrays or a single function followed by objects can be merged!")),[i,j].indexOf(b.types.array)===-1||i===b.types.array&&j===b.types.array||(k=b.InvalidParametersException("msngr.merge()","Arrays cannot be merged with objects or functions!")),void 0!==k){if(h===!0)return g;throw k}var l=f;if(i===b.types.array&&j===b.types.array)return f.concat(g);for(var m in g)if(g.hasOwnProperty(m)){var n=a.is(g[m]);n.object?(l[m]=l[m]||{},l[m]=e(l[m],g[m])):n.array?(l[m]=l[m]||[],l[m]=l[m].concat(g[m])):l[m]=g[m]}return l};b.merge=function(){var a=Array.prototype.slice.call(arguments,0);if(a.length<=1)return a[0];for(var b=a.shift();a.length>0;)b=e(b,a.shift(),!0);return b},a.merge=function(){var a=Array.prototype.slice.call(arguments,0);if(a.length<=1)return a[0];for(var b=a.shift();a.length>0;)b=e(b,a.shift());return b}}),msngr.extend(function(a,b){"use strict";a.safe=function(c,d,e){if(!a.is(c).object||!a.is(d).string)throw b.InvalidParametersException("msngr.safe");for(var f=d.split("."),g=c,h=void 0;(h=f.shift())&&(g=g[h],void 0!==g););return a.is(g).there?g:e}}),msngr.extend(function(a,b){"use strict";b.executer=function(b){for(var c=0;c<b.length;++c)a.is(b[c]).function&&(b[c]={method:b[c]});var d=function(b,c,d,e){var f=a.is(c);a.immediate(function(){var a=!1,g=function(){return a=!0,function(a){e.apply(d,[a])}};f.array||(c=f.there?[c]:[]),c.push(g);var h=b.apply(d||this,c);a!==!0&&e.apply(d,[h])})};return{parallel:function(c){var e=a.is(c),f=[],g=0;if(0===b.length&&e.there)return c.apply(null,[[]]);for(var h=0;h<b.length;++h){var i=b[h].method,j=b[h].params,k=b[h].context;!function(h,i,j){d(h,i,j,function(d){a.is(d).there&&f.push(d),++g,g===b.length&&e.there&&c.apply(j||null,[f])})}(i,j,k)}},series:function(c){var e=a.is(c),f=[];if(0===b.length&&e.there)return c.apply(null,[[]]);var g=function(){var h=b.shift();!function(h,i,j){d(h,i,j,function(d){a.is(d).there&&f.push(d),0===b.length&&e.there?c.apply(j||null,[f]):g()})}(h.method,h.params,h.context)};g()}}},a.parallel=function(a,c){b.executer(a).parallel.apply(this,[c])},a.series=function(a,c){b.executer(a).series.apply(this,[c])}}),msngr.extend(function(a,b){"use strict";var c=function(a){return void 0!==a&&null!==a},d=function(a,b){var c=a.indexOf(b),d=a.length-1;if(c!==d){var e=a[d];a[d]=a[c],a[c]=e}a.pop()};b.memory=function(){var b={},e={},f=0,g={index:function(d){if(c(d)&&c(d.topic)){var g=a.id();return b[g]=a.copy(d),c(e[d.topic])||(e[d.topic]={ids:[],category:{}}),c(e[d.topic].category[d.category])||(e[d.topic].category[d.category]={ids:[],subcategory:{}}),c(e[d.topic].category[d.category].subcategory[d.subcategory])||(e[d.topic].category[d.category].subcategory[d.subcategory]={ids:[]}),c(d.category)||c(d.subcategory)||e[d.topic].ids.push(g),c(d.category)&&!c(d.subcategory)&&e[d.topic].category[d.category].ids.push(g),c(d.category)&&c(d.subcategory)&&e[d.topic].category[d.category].subcategory[d.subcategory].ids.push(g),f++,g}},getById:function(a){return b[a]},delete:function(a){if(c(a)&&c(b[a])){var g=b[a];return d(e[g.topic].ids,a),d(e[g.topic].category[g.category].ids,a),d(e[g.topic].category[g.category].subcategory[g.subcategory].ids,a),delete b[a],f--,!0}return!1},query:function(b){var d=[];if(c(b)&&c(b.topic)&&c(e[b.topic])){var f=e[b.topic],g=((f||{}).category||{})[b.category],h=((g||{}).subcategory||{})[b.subcategory];d=d.concat(f.ids||[]),d=d.concat((g||{}).ids||[]),d=d.concat((h||{}).ids||[])}return a.deDupeArray(d)},clear:function(){return b={},e={},f=0,!0}};return Object.defineProperty(g,"count",{get:function(){return f}}),g}}),msngr.extend(function(a,b){"use strict";var c=b.memory(),d=b.memory(),e={},f=0,g={},h=0;Object.defineProperty(b,"handlerCount",{get:function(){return f}}),Object.defineProperty(b,"payloadCount",{get:function(){return h}}),b.reset=function(){e={},f=0,c.clear(),d.clear(),g={},h=0};var i=function(b){var c=d.query(b);if(0!==c.length){var e=g[c[0]];if(c.length>1)for(var f=1;f<c.length;++f)e=a.merge(innerPay,fpay);return e}},j=function(d,f,g,h){b.executeMiddlewares(f,g,function(f){var g=a.is(d).array?d:c.query(d);if(g.length>0){for(var i=[],j=[],k=0;k<g.length;++k){var l=a.is(d).object?a.copy(d):a.copy(c.query(g[k])),m=e[g[k]];i.push({method:m.handler,params:[f,l]}),m.once===!0&&j.push({msg:l,handler:m.handler})}for(var n=b.executer(i),k=0;k<j.length;++k)a(j[k].msg).drop(j[k].handler);n.parallel(h)}})};a.message=function(k,l,m){var n=a.is(k),o=a.is(l),p=a.is(m);if(!n.there)throw b.InvalidParametersException("msngr()");if(!n.object&&!n.string)throw b.InvalidParametersException("msngr()");if(n.empty)throw b.InvalidParametersException("msngr()");var q;n.object?q=a.copy(k):(q={},q.topic=k,!o.empty&&o.string&&(q.category=l),!p.empty&&p.string&&(q.subcategory=m));for(var r in q)q.hasOwnProperty(r)&&(q[r]=q[r].toLowerCase());var s=[],t={use:function(b){return a.is(b).empty||s.push(b.toLowerCase()),t},emit:function(b,c){var d=a.is(b);return d.function&&(c=b,b=void 0),j(q,s,b,c),t},persist:function(b){void 0===b&&(b=null);var c=d.query(q);if(0===c.length){var e=d.index(q);g[e]=b,c=[e]}else for(var f=0;f<c.length;++f)g[c[f]]=a.merge(b,g[c[f]]);return++h,t.emit(i(q))},cease:function(){for(var a=d.query(q),b=0;b<a.length;++b)delete g[a[b]],--h;return t},on:function(a){var b=c.index(q);e[b]={handler:a,context:q.context||this,once:!1},f++;var d=i(q);return void 0!==d&&j([b],s,d,void 0),t},once:function(a){var b=c.index(q);e[b]={handler:a,context:q.context||this,once:!0},f++;var d=i(q);return void 0!==d&&j([b],s,d,void 0),t},drop:function(a){var b=c.query(q);if(b.length>0)for(var d=0;d<b.length;++d){var g=b[d];e[g].handler===a&&(delete e[g],f--,c.delete(g))}return t},dropAll:function(){var a=c.query(q);if(a.length>0)for(var b=0;b<a.length;++b){var d=a[b];delete e[d],f--,c.delete(d)}return t}};return Object.defineProperty(t,"message",{get:function(){return q}}),Object.defineProperty(t,"topic",{get:function(){return q.topic}}),Object.defineProperty(t,"category",{get:function(){return q.category}}),Object.defineProperty(t,"subcategory",{get:function(){return q.subcategory}}),Object.defineProperty(t,"handlers",{get:function(){return c.query(q).length}}),t}}),msngr.extend(function(a,b){"use strict";var c={},d=[];b.getMiddlewares=function(a,b){for(var e=[],f=(a||[]).concat(d),g=0;g<f.length;++g)void 0!==c[f[g]]&&e.push({method:c[f[g]],params:b});return e},b.executeMiddlewares=function(a,c,d){var e=b.getMiddlewares(a,c);b.executer(e).series(function(a){return d(b.merge.apply(this,[c].concat(a)))})},a.middleware=function(e,f,g){var h=a.is(e),i=a.is(f);if(!h.there||!h.string||h.empty||!i.there||!i.function)throw b.InvalidParametersException("msngr.middleware()");if(a.is(c[e]).there)throw b.DuplicateException("msngr.middleware()");var j=e.toLowerCase();c[j]=f,g===!0&&d.push(j)},a.unmiddleware=function(e){var f=a.is(e);if(!f.there||!f.string||f.empty)throw b.InvalidParametersException("msngr.unmiddleware()");var g=e.toLowerCase(),h=d.indexOf(g);h!==-1&&d.splice(h,1),void 0!==c[g]&&delete c[g]}}),msngr.extend(function(a,b){"use strict";a.mache=function(c){c=c||{};var d={events:{onChange:{topic:"msngr.mache",category:"change",emit:c.emitChanges||!1}},revisions:{toKeep:c.revisions||3}},e={},f={},g=void 0,h=void 0,i=!1,j=function(a){if(void 0!==f[a])return f[a][f[a].length-1]},k=function(a){return h[a]===!0?void 0:g[a]||j(a)},l=function(c,g){if(void 0===f[c]&&(f[c]=[]),f[c].push(b.merge(a.copy(q.get(c)),a.copy(g))),e[c]=q.get(c),f[c].length>d.revisions.toKeep&&f[c].shift(),d.events.onChange.emit){var h=a.message(d.events.onChange.topic,d.events.onChange.category,c);h.emit({id:c,oldValue:f[c][f[c].length-2],newValue:f[c][f[c].length-1]})}return!0},m=function(c,d){return g[c]=b.merge(g[c]||j(c),a.copy(d)),!0},n=function(a){return void 0!==f[a]&&(delete f[a],delete e[a],!0)},o=function(a){return(void 0!==g[a]||void 0!==f[a])&&(void 0!==g[a]&&delete g[a],h[a]=!0,!0)},p=function(a){return void 0!==f[a]&&(1===f[a].length?(delete f[a],delete e[a],!0):(f[a].pop(),e[a]=q.get(a),!0))},q={get:function(a){return i?k(a):j(a)},getDeep:function(b,c,d){var e=q.get(b);if(void 0===e||a.is(c).empty)return d;for(var f=c.trim().split("."),g=e,h=0;h<f.length;++h){if(void 0===g[f[h]])return d;g=g[f[h]]}return a.is(g).there?g:d},set:function(a,b){return i?m(a,b):l(a,b)},remove:function(a){return i?o(a):n(a)},revert:function(a){return!i&&p(a)},begin:function(){return!i&&(i=!0,g={},h={},!0)},rollback:function(){return!!i&&(i=!1,g=void 0,h=void 0,!0)},commit:function(){if(!i)return!1;i=!1;for(var a in g)g.hasOwnProperty(a)&&l(a,g[a]);for(var a in h)h.hasOwnProperty(a)&&n(a);return g=void 0,h=void 0,!0}};return Object.defineProperty(q,"meta",{configurable:!1,enumerable:!1,get:function(){return d}}),Object.defineProperty(q,"data",{configurable:!1,enumerable:!1,get:function(){return i?b.merge(a.copy(e),g):e}}),Object.defineProperty(q,"count",{configurable:!1,enumerable:!1,get:function(){return Object.keys(q.data).length}}),q},a.config=a.mache()}),msngr.extend(function(a,b){"use strict";b.net=b.net||{},b.net.browser=function(b,c,d){try{var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status||201===e.status){var b;if(c.autoJson===!0&&"application/json"===(this.getResponseHeader("content-type")||"").toLowerCase())try{b=JSON.parse(e.response)}catch(a){b=void 0}a.is(d).there&&d.apply(void 0,[null,b||e.response])}else{var f={status:e.status,response:e.response};a.is(d).there&&d.apply(void 0,[f,null])}};var f=b.protocol+"://"+b.host;b.canOmitPort===!0?f+=c.path:f=f+":"+b.port+c.path;var g;if(a.is(c.payload).there){if(a.is(c.payload).object)try{g=JSON.stringify(c.payload)}catch(a){}void 0===g&&(g=c.payload)}if(e.open(c.method,f,!0),a.is(c.headers).there)for(var h in c.headers)c.headers.hasOwnProperty(h)&&e.setRequestHeader(h,c.headers[h]);e.send(g)}catch(b){a.is(d).there&&d.apply(void 0,[b,null])}}}),msngr.extend(function(a,b){"use strict";b.net=b.net||{};var c={path:"/",protocol:"http",port:{http:"80",https:"443"},autoJson:!0},d=function(c,d,e){if(a.is(d.query).there&&(a.is(d.query).string&&(d.queryString=d.query),a.is(d.query).object)){d.queryString="?";for(var f in d.query)d.query.hasOwnProperty(f)&&("?"!==d.queryString&&(d.queryString=d.queryString+"&"),d.queryString=d.queryString+encodeURIComponent(f)+"="+encodeURIComponent(d.query[f]))}d.path=d.path+(d.queryString||""),a.is.browser?b.net.browser(c,d,e):b.net.node(c,d,e)},e=function(d,e,f){var g,h={protocol:void 0,host:void 0,port:void 0,canOmitPort:!1},i=!1,j=!1;if(a.is(d).empty&&(j=!0,g="Protocol or host not provided"),!j&&!a.is(d).empty&&a.is(e).empty&&a.is(f).empty){var k=d.split("://");2==k.length?(h.protocol=k[0],h.host=k[1]):(h.host=d,h.protocol=c.protocol);var l=h.host.lastIndexOf(":");l!==-1?(h.port=h.host.substring(l+1,h.host.length),h.host=h.host.substring(0,l)):h.port=c.port[h.protocol],i=!0}if(!j&&!i&&!a.is(d).empty&&!a.is(e).empty&&a.is(f).empty){h.protocol=d,h.host=e;var l=h.host.lastIndexOf(":");l!==-1?(h.port=h.host.substring(l+1,h.host.length),h.host=h.host.substring(0,l)):h.port=c.port[h.protocol],i=!0}if(j||i||a.is(d).empty||a.is(e).empty||a.is(f).empty||(h.protocol=d,h.host=e,h.port=f,i=!0),!j&&i&&c.port[h.protocol]===h.port&&(h.canOmitPort=!0),j||i||(j=!0,g="Unable to handle input into method. Please open a GitHub issue with your input :)"),j===!0)throw b.InvalidParametersException("net",g);var m=function(a){var b=a.indexOf("/");return a.substring(0,b===-1?a.length:b)};return h.host=m(h.host),h.port=m(h.port),h};a.net=function(f,g,h){var i=e(f,g,h),j={get:function(e,f){var g=b.merge(a.copy(c),e);g.method="get",d(i,g,f)},post:function(e,f){var g=b.merge(a.copy(c),e);g.method="post",d(i,g,f)},put:function(e,f){var g=b.merge(a.copy(c),e);g.method="put",d(i,g,f)},delete:function(e,f){var g=b.merge(a.copy(c),e);g.method="delete",d(i,g,f)},options:function(e,f){var g=b.merge(a.copy(c),e);g.method="options",d(i,g,f)}};return Object.defineProperty(j,"protocol",{get:function(){return i.protocol}}),Object.defineProperty(j,"host",{get:function(){return i.host}}),Object.defineProperty(j,"port",{get:function(){return i.port}}),j}}),msngr.extend(function(a,b){"use strict";b.net=b.net||{},b.net.node=function(b,c,d){var e=require("http"),f=e.request({method:c.method,host:b.host,port:b.port,path:c.path,headers:c.headers},function(b){b.setEncoding("utf8");var e="";b.on("data",function(a){e+=a}),b.on("end",function(){var g;if(c.autoJson===!0&&"application/json"===(b.headers["content-type"]||"").toLowerCase())try{g=JSON.parse(e)}catch(a){g=void 0}g=g||e;var h;f.statusCode>=400&&(h={status:f.statusCode,response:g||e},g=null),a.is(d).there&&d.apply(void 0,[h,g])})});if(a.is(c.payload).there){var g;if(a.is(c.payload).object)try{g=JSON.stringify(c.payload)}catch(a){}void 0===g&&(g=c.payload),f.write(g)}f.end()}}),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=msngr);